<div class="combat" [class.minimized]="minimized">
  <div class="min-btn" (click)="minimized = !minimized">{{minimized ? title : '-'}}</div>
  <h2>{{title}}</h2>




  <!-- View for attacker -->
  <div class="arena" *ngIf="attacker === 'A'">
    <div class="creature-list">
      <div class="combat-col" *ngFor="let col of combatCards">

        <!-- Defending Creature -->
        <div class="panel-card" *ngIf="col.defendingCard" (mouseover)="hoverCard.emit(col.defendingCard)" (mouseleave)="clearHover.emit()"
             [class.is-dying]="col.defendingCard.defense <= (col.defendingCard.damage || 0)">
          <img [src]="'/assets/images/cards/' + col.defendingCard.image">
          <span class="damage-points" *ngIf="col.defendingCard.damage">
            <span>{{col.defendingCard.damage}}</span>
            <span class="icon-power"></span>
          </span>
        </div>

        <!-- Empty Slot for defender -->
        <div class="panel-card empty-slot" *ngIf="!col.defendingCard"
             [class.is-hidden]="subPhase === 'selectAttack'">
          <img>
          <span class="damage-points" *ngIf="subPhase === 'afterCombat' && col.attackingCard.attack">
            <span>{{col.attackingCard.attack}}</span>
            <span class="icon-power"></span>
          </span>
        </div>

        <!-- Damage Arrows -->
        <div class="combat-arrows">          
          <div class="combat-arrow">
            <span class="damage left bottom">{{col.attackingCard.attack}}<span class="icon-power"></span></span>
            <!-- <span class="damage left top" *ngIf="col.defendingCard">{{col.defendingCard.defense}}<span class="icon-shield2"></span></span> -->
            <span class="icon-arrow-up16"></span>
          </div>
          <div class="combat-arrow" *ngIf="col.defendingCard">
            <span class="icon-arrow-down16"></span>
            <span class="damage right top">{{col.defendingCard.attack}}<span class="icon-power"></span></span>
            <!-- <span class="damage right bottom">{{col.attackingCard.defense}}<span class="icon-shield2"></span></span> -->
          </div>
        </div>

        <!-- Attacking Creature -->
        <div class="panel-card" (mouseover)="hoverCard.emit(col.attackingCard)" (mouseleave)="clearHover.emit()"
             [class.is-dying]="col.attackingCard.defense <= (col.attackingCard.damage || 0)">
          <img [src]="'/assets/images/cards/' + col.attackingCard.image">
          <span class="damage-points" *ngIf="col.attackingCard.damage">
            <span>{{col.attackingCard.damage}}</span>
            <span class="icon-power"></span>
          </span>
        </div>

      </div>
    </div>
  </div>





  <!-- View for defender -->
  <div class="arena" *ngIf="attacker === 'B'">
    <div class="creature-list">
      <div class="combat-col" *ngFor="let col of combatCards" 
           [class.is-selectable]="!!defenderLookingForTarget"
           (click)="clickCol(col)"
           (mouseover)="hoverCol(col)"
           (mouseleave)="hoverCol()">

        <!-- Attacking Creature -->
        <div class="panel-card" (mouseover)="hoverCard.emit(col.attackingCard)" (mouseleave)="clearHover.emit()"
             [class.is-dying]="col.attackingCard.defense <= (col.attackingCard.damage || 0)">
          <img [src]="'/assets/images/cards/' + col.attackingCard.image">
          <span class="damage-points" *ngIf="col.attackingCard.damage">
            <span>{{col.attackingCard.damage}}</span>
            <span class="icon-power"></span>
          </span>
        </div>

        <!-- Damage Arrows -->
        <div class="combat-arrows">
          <div class="combat-arrow">
            <span class="damage left top">{{col.attackingCard.attack}}<span class="icon-power"></span></span>
            <!-- <span class="damage left bottom" *ngIf="col.defendingCard">{{col.defendingCard.defense}}<span class="icon-shield2"></span></span> -->
            <span class="icon-arrow-down16"></span>
          </div>
          <div class="combat-arrow" *ngIf="col.defendingCard">
            <span class="icon-arrow-up16"></span>
            <!-- <span class="damage right top">{{col.attackingCard.defense}}<span class="icon-shield2"></span></span> -->
            <span class="damage right bottom">{{col.defendingCard.attack}}<span class="icon-power"></span></span>
          </div>
        </div>

        <!-- Defending Creature -->
        <div class="panel-card" *ngIf="col.defendingCard" (mouseover)="hoverCard.emit(col.defendingCard)" (mouseleave)="clearHover.emit()"
             [class.is-dying]="col.defendingCard.defense <= (col.defendingCard.damage || 0)">
          <img [src]="'/assets/images/cards/' + col.defendingCard.image">
          <span class="damage-points" *ngIf="col.defendingCard.damage">
            <span>{{col.defendingCard.damage}}</span>
            <span class="icon-power"></span>
          </span>
        </div>

        <!-- Empty Slot for defender -->
        <div class="panel-card" *ngIf="!col.defendingCard" 
             [class.empty-slot]="!col.hoverDefender"
             (mouseover)="col.hoverDefender && hoverCard.emit(col.hoverDefender)" (mouseleave)="clearHover.emit()">
          <img [hidden]="col.hoverDefender">
          <img [hidden]="!col.hoverDefender" [src]="'/assets/images/cards/' + col.hoverDefender?.image">
          <span class="damage-points" *ngIf="subPhase === 'afterCombat' && col.attackingCard.attack">
            <span>{{col.attackingCard.attack}}</span>
            <span class="icon-power"></span>
          </span>
        </div>
        <!-- defenderLookingForTarget={{defenderLookingForTarget?.name | json}} -->

      </div>
    </div>
  </div>


  

  <div>
    <div>CONTROL = {{game.state.control}}</div>   
    subPhase={{subPhase}}
    <span *ngIf="itemInfo">{{itemInfo}}</span>
    <span *ngIf="!itemInfo">{{mainInfo}}</span>
  </div>
  

  <div class="btns-box">
    <bf-btn *ngIf="attacker === 'A' && subPhase === 'selectAttack'"  bfText="Cancel"  [bfDisabled]="!youControl" (bfClick)="cancelAttack()"  bfIcon="icon-cross"></bf-btn>
    <bf-btn *ngIf="attacker === 'A' && subPhase === 'selectAttack'"  bfText="Submit Attack"  [bfDisabled]="!youControl" (bfClick)="submitAttack()"  bfIcon="icon-arrow-right3"></bf-btn>

    <bf-btn *ngIf="attacker === 'B' && subPhase === 'selectDefense' && anyDefenders" bfText="Cancel"  [bfDisabled]="!youControl" (bfClick)="cancelDefense()" bfIcon="icon-cross"></bf-btn>
    <bf-btn *ngIf="attacker === 'B' && subPhase === 'selectDefense'" [bfText]="submitDefenseBtnText" [bfDisabled]="!youControl" (bfClick)="submitDefense()" bfIcon="icon-arrow-right3"></bf-btn>

    <bf-btn *ngIf="subPhase === 'afterCombat'" bfText="Ok, continue" [bfDisabled]="!youControl" (bfClick)="endCombat()" bfIcon="icon-arrow-right3"></bf-btn>
  </div>

</div>